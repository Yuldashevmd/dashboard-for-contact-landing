import{r as o,j as t,B as x,q as F}from"./index-8cf2d033.js";import{u as I,T}from"./index-c92049f1.js";import{F as a,u as b}from"./useMutation-576a8117.js";import{I as l,r as k,s as S,T as p,t as _}from"./actions-210159a0.js";import{Q as q}from"./react-toastify.esm-886a0e0b.js";import{D as v,P as w,T as D}from"./index-1417cac4.js";import"./Sider-e3d14542.js";const B=()=>{const[i]=a.useForm(),[y,c]=o.useState(!1),[d,m]=o.useState(null),{data:n,isPending:h}=I({queryKey:["statistics"],queryFn:_,refetchOnWindowFocus:!1}),r=b({mutationFn:e=>k(e)}),f=async e=>{r.mutate(e.id),r.isSuccess&&(F.invalidateQueries({queryKey:["statistics"]}),q.success(r.data,{position:"bottom-right"}))},j=async e=>{const s=await S(d.id,e);console.log(s,"res")},u=()=>{o.startTransition(()=>{c(!1),m(null),i.resetFields()})},g=[{title:"Название",dataIndex:"title",key:"title",flex:1},{title:"Кол-во",dataIndex:"statistic",key:"statistic",flex:1,align:"center"},{title:"Дата создания",dataIndex:"create_data",key:"create_data",flex:1,align:"center"},{title:"Дейтсвия",dataIndex:"action",key:"action",flex:1,align:"center",render:(e,s)=>t.jsxs("div",{className:"d-flex align-center justify-center gap-x-1",children:[t.jsx(p,{title:"Изменить",placement:"top",children:t.jsx(w,{cursor:"pointer",size:20,color:"#252525",onClick:()=>{c(!0),m(s),i.setFieldValue("title",s.title),i.setFieldValue("title_ru",s.title_ru),i.setFieldValue("title_en",s.title_en),i.setFieldValue("statistic",s.statistic)}})}),t.jsx(p,{title:"Удалить",placement:"top",children:t.jsx(D,{cursor:"pointer",size:20,color:"#252525",onClick:()=>f(s)})})]})}];return t.jsxs("main",{className:"statistics",children:[t.jsx("h1",{children:"Statistics"}),t.jsx("div",{className:"history-table m-t-2",children:t.jsx(T,{loading:h,column:g,row:n==null?void 0:n.map(e=>({...e,key:e.id}))})}),t.jsx(v,{history:{record:d,open:y,closeDrawer:u,title:"Добавить",footer:t.jsxs("div",{className:"d-flex align-center gap-x-2",children:[t.jsx(x,{type:"primary",form:"history-form",htmlType:"submit",children:"Сохранить"}),t.jsx(x,{danger:!0,onClick:u,children:"Отмена"})]})},children:t.jsxs(a,{typeof:"form-data",onFinish:j,form:i,id:"history-form",layout:"vertical",children:[t.jsx(a.Item,{name:"title",label:"Название UZ",children:t.jsx(l,{type:"text"})}),t.jsx(a.Item,{name:"title_ru",label:"Название РУ",children:t.jsx(l,{type:"text"})}),t.jsx(a.Item,{name:"title_en",label:"Название EN",children:t.jsx(l,{type:"text"})}),t.jsx(a.Item,{name:"statistic",label:"Статистика",children:t.jsx(l,{type:"text"})})]})})]})};export{B as default};
