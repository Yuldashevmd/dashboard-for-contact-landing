import{r as o,j as t,B as m,q as x}from"./index-09831358.js";import{u as I,T}from"./index-c0bdb8e7.js";import{F as a,u as k}from"./useMutation-e6a1004b.js";import{I as l,r as _,s as b,T as p,t as S}from"./actions-53774f65.js";import{D as q,P as v,T as w}from"./index-93934f2f.js";import"./Sider-1d4f0c6e.js";import"./react-toastify.esm-cdfe1485.js";const Q=()=>{const[i]=a.useForm(),[y,c]=o.useState(!1),[d,u]=o.useState(null),{data:n,isPending:h}=I({queryKey:["statistics"],queryFn:S,refetchOnWindowFocus:!1}),j=k({mutationFn:e=>_(e)}),f=async e=>{j.mutate(e.id),x.invalidateQueries({queryKey:["statistics"]})},g=async e=>{const s=await b(d.id,e);x.invalidateQueries({queryKey:["statistics"]}),r(),console.log(s,"res")},r=()=>{o.startTransition(()=>{c(!1),u(null),i.resetFields()})},F=[{title:"Название",dataIndex:"title",key:"title",flex:1},{title:"Кол-во",dataIndex:"statistic",key:"statistic",flex:1,align:"center"},{title:"Дата создания",dataIndex:"create_data",key:"create_data",flex:1,align:"center"},{title:"Дейтсвия",dataIndex:"action",key:"action",flex:1,align:"center",render:(e,s)=>t.jsxs("div",{className:"d-flex align-center justify-center gap-x-1",children:[t.jsx(p,{title:"Изменить",placement:"top",children:t.jsx(v,{cursor:"pointer",size:20,color:"#252525",onClick:()=>{c(!0),u(s),i.setFieldValue("title",s.title),i.setFieldValue("title_ru",s.title_ru),i.setFieldValue("title_en",s.title_en),i.setFieldValue("statistic",s.statistic)}})}),t.jsx(p,{title:"Удалить",placement:"top",children:t.jsx(w,{cursor:"pointer",size:20,color:"#252525",onClick:()=>f(s)})})]})}];return t.jsxs("main",{className:"statistics",children:[t.jsx("h1",{children:"Statistics"}),t.jsx("div",{className:"history-table m-t-2",children:t.jsx(T,{loading:h,column:F,row:n==null?void 0:n.map(e=>({...e,key:e.id}))})}),t.jsx(q,{history:{record:d,open:y,closeDrawer:r,title:"Добавить",footer:t.jsxs("div",{className:"d-flex align-center gap-x-2",children:[t.jsx(m,{type:"primary",form:"history-form",htmlType:"submit",children:"Сохранить"}),t.jsx(m,{danger:!0,onClick:r,children:"Отмена"})]})},children:t.jsxs(a,{typeof:"form-data",onFinish:g,form:i,id:"history-form",layout:"vertical",children:[t.jsx(a.Item,{name:"title",label:"Название UZ",children:t.jsx(l,{type:"text"})}),t.jsx(a.Item,{name:"title_ru",label:"Название РУ",children:t.jsx(l,{type:"text"})}),t.jsx(a.Item,{name:"title_en",label:"Название EN",children:t.jsx(l,{type:"text"})}),t.jsx(a.Item,{name:"statistic",label:"Статистика",children:t.jsx(l,{type:"text"})})]})})]})};export{Q as default};
